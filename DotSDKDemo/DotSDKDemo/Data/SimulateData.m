//
//  simulateData.m
//  RestonSDKDemo
//
//  Created by San on 2017/8/9.
//  Copyright © 2017年 medica. All rights reserved.
//

#import "SimulateData.h"
#import "SimulateData+ScoreDeduction.h"

@implementation SimulateData

+ (UserObj *)simulateData
{
    UserObj *obj=[[UserObj alloc]init];
    obj.farmlyID=[NSNumber numberWithInteger:0];
    obj.memID=[NSNumber numberWithInteger:0];
    obj.date=@"2016-11-16";    obj.SleepCurveStr=@"[0.062540999999999999,0.058724999999999999,0.065542000000000003,0.069988999999999996,0.065416000000000002,0.068526000000000004,0.064940999999999999,0.060794000000000001,0.061166999999999999,0.058396999999999998,0.063292000000000001,0.065437999999999996,0.079830999999999999,0.079625000000000001,0.074010999999999993,0.062522999999999995,0.064088999999999993,0.059354999999999998,0.054355000000000001,0.072816000000000006,0.063374,0.057164,0.063779000000000002,0.050025,0.053492999999999999,0.071147000000000002,0.083149000000000001,0.069754999999999998,0.060164000000000002,0.054401999999999999,0.057915000000000001,0.072591000000000003,0.068803000000000003,0.065573000000000006,0.053345999999999998,0.043401000000000002,0.062325999999999999,0.067712999999999995,0.059348999999999999,0.058720000000000001,0.066231999999999999,0.064379000000000006,0.050264999999999997,0.045261999999999997,0.062923000000000007,0.074915999999999996,0.068195000000000006,0.053894999999999998,0.054209,0.056993000000000002,0.0625,0.25484000000000001,0.441328,0.62196499999999999,0.79956499999999997,0.97131400000000001,1.1400269999999999,1.3028869999999999,1.4807269999999999,1.6464019999999999,1.7970980000000001,1.9328160000000001,2.0535540000000001,2.1593140000000002,2.2545549999999999,2.3392789999999999,2.4090240000000001,2.474205,2.534821,2.590875,2.6423649999999999,2.6892900000000002,2.7316509999999998,2.76945,2.8026840000000002,2.8313540000000001,2.855461,2.8600240000000001,2.850133,2.822317,2.7846099999999998,2.7431860000000001,2.698045,2.6491850000000001,2.5966089999999999,2.5403159999999998,2.4803060000000001,2.4165779999999999,2.3491330000000001,2.277971,2.1969180000000001,2.1141359999999998,2.0296270000000001,1.94339,1.855426,1.765733,1.6743129999999999,1.5811649999999999,1.5060720000000001,1.4490339999999999,1.406334,1.3816889999999999,1.3627499999999999,1.3495189999999999,1.3419939999999999,1.3401749999999999,1.3440639999999999,1.353658,1.36896,1.3899680000000001,1.4166829999999999,1.4532890000000001,1.488677,1.522848,1.5558000000000001,1.587534,1.61805,1.647348,1.67021,1.6831750000000001,1.686242,1.68127,1.666401,1.6478079999999999,1.6254930000000001,1.5994539999999999,1.5696909999999999,1.536206,1.4989969999999999,1.451635,1.397837,1.3376030000000001,1.2810859999999999,1.2222980000000001,1.1630959999999999,1.1016220000000001,1.0397350000000001,0.975576,0.91436300000000004,0.86653100000000005,0.81922099999999998,0.77243300000000004,0.72616700000000001,0.680423,0.62998299999999996,0.58358299999999996,0.54122400000000004,0.50290500000000005,0.46862700000000002,0.43838899999999997,0.42505100000000001,0.421178,0.42677100000000001,0.433666,0.454515,0.485601,0.53064100000000003,0.58591700000000002,0.65514799999999995,0.72789700000000002,0.79894699999999996,0.87472799999999995,0.95523899999999995,1.0404800000000001,1.130452,1.23559,1.338422,1.4389460000000001,1.5371649999999999,1.6330769999999999,1.7179450000000001,1.785342,1.838983,1.880727,1.9087160000000001,1.9229499999999999,1.9252860000000001,1.9138679999999999,1.886835,1.848759,1.804859,1.7551330000000001,1.6995819999999999,1.6382060000000001,1.571005,1.4979789999999999,1.4139109999999999,1.3275349999999999,1.238853,1.141435,1.037139,0.94157900000000005,0.86033199999999999,0.79339599999999999,0.73705500000000002,0.69502699999999995,0.65987600000000002,0.63160300000000003,0.61020799999999997,0.597549,0.58866200000000002,0.58354700000000004,0.58220499999999997,0.58463399999999999,0.590835,0.60080800000000001,0.61455400000000004,0.63207199999999997,0.65336099999999997,0.678423,0.72011599999999998,0.77472399999999997,0.83722600000000003,0.89647299999999996,0.95246299999999995,1.007055,1.0583910000000001,1.110187,1.154549,1.1914769999999999,1.2348349999999999,1.275261,1.312756,1.347321,1.378954,1.407656,1.4334279999999999,1.4562679999999999,1.4761770000000001,1.493155,1.500772,1.498491,1.4881690000000001,1.4679489999999999,1.443406,1.414539,1.3813489999999999,1.3438369999999999,1.302001,1.2657419999999999,1.238775,1.202666,1.1653100000000001,1.1229899999999999,1.0809230000000001,1.0391109999999999,0.99755099999999997,0.95624500000000001,0.91519300000000003,0.874394,0.82863100000000001,0.79556800000000005,0.76342100000000002,0.73219000000000001,0.70187600000000006,0.67247800000000002,0.63919199999999998,0.607236,0.57660900000000004,0.54731300000000005,0.52323399999999998,0.49693799999999999,0.47485500000000003,0.451768,0.436969,0.41816500000000001,0.39535399999999998,0.372255,0.34886699999999998,0.32519100000000001,0.29750799999999999,0.28183200000000003,0.26212200000000002,0.24427099999999999,0.22827900000000001,0.214145,0.20186999999999999,0.20106199999999999,0.19571,0.19103200000000001,0.187028,0.17780699999999999,0.16708500000000001,0.154862,0.15157399999999999,0.144569,0.145728,0.15504999999999999,0.16215499999999999,0.17262,0.186444,0.211061,0.230103,0.24837300000000001,0.265872,0.28260000000000002,0.29298000000000002,0.29701300000000003,0.29715599999999998,0.309778,0.32444400000000001,0.34115299999999998,0.359906,0.38070199999999998,0.40354200000000001,0.42320799999999997,0.45199400000000001,0.48214899999999999,0.51367399999999996,0.55617799999999995,0.59850899999999996,0.64066699999999999,0.67167299999999996,0.705735,0.74285100000000004,0.78302400000000005,0.82625099999999996,0.88368500000000005,0.95532600000000001,1.0266519999999999,1.0920859999999999,1.1568449999999999,1.220931,1.2843439999999999,1.3470819999999999,1.409146,1.470537,1.5260359999999999,1.578589,1.628196,1.6719120000000001,1.7153119999999999,1.7583949999999999,1.8156870000000001,1.8699220000000001,1.9211020000000001,1.9692270000000001,2.0056660000000002,2.0291579999999998,2.0397029999999998,2.0445630000000001,2.0437370000000001,2.0329109999999999,2.0176599999999998,1.997984,1.9738819999999999,1.9453560000000001,1.9124049999999999,1.8750279999999999,1.8332269999999999,1.7814239999999999,1.7214799999999999,1.6515340000000001,1.571588,1.4780960000000001,1.379691,1.2763709999999999,1.1644209999999999,1.065906,0.97219599999999995,0.88329000000000002,0.79918900000000004,0.71989099999999995,0.64922500000000005,0.57975600000000005,0.51148400000000005,0.44440800000000003,0.37481100000000001,0.30826999999999999,0.244784,0.18435399999999999,0.13813,0.102396,0.080869999999999997,0.073550000000000004,0.067426,0.0625,0.063575000000000007,0.078085000000000002,0.087790999999999994,0.097006999999999996,0.105735,0.10917,0.111627,0.11840000000000001,0.12762899999999999,0.13931499999999999,0.149143,0.169351,0.18878800000000001,0.207453,0.22534699999999999,0.23689399999999999,0.239148,0.23691300000000001,0.230189,0.233846,0.24788299999999999,0.26269100000000001,0.27455299999999999,0.288275,0.30385400000000001,0.321293,0.35019899999999998,0.38194099999999997,0.40505200000000002,0.42805399999999999,0.45094600000000001,0.48235899999999998,0.508969,0.53634999999999999,0.559697,0.58544200000000002,0.61358299999999999,0.65373000000000003,0.69255599999999995,0.73006099999999996,0.76067099999999999,0.78438300000000005,0.80600400000000005,0.82553299999999996,0.84297,0.85188600000000003,0.85228000000000004,0.84642399999999995,0.83863399999999999,0.84223499999999996,0.84762000000000004,0.85478799999999999,0.85942399999999997,0.86633099999999996,0.87551100000000004,0.89657100000000001,0.91665300000000005,0.93575600000000003,0.949075,0.96327499999999999,0.97232799999999997,0.970549,0.97854200000000002,0.96631800000000001,0.955206,0.95036399999999999,0.95742799999999995,0.96959399999999996,0.976271,0.98462499999999997,0.97195799999999999,0.94767000000000001,0.91695800000000005,0.88319499999999995,0.85421199999999997,0.80700300000000003,0.74616199999999999,0.69699699999999998,0.63900199999999996,0.58394999999999997,0.53113699999999997,0.47133700000000001,0.41706900000000002,0.36053600000000002,0.31911600000000001,0.27836499999999997,0.22383700000000001,0.18875800000000001,0.15826599999999999,0.105252,0.069519999999999998,0.074118000000000003]";
    
    obj.sleepCurveStatusStr=@"[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0]";
    
    obj.deductionName=@[@"restless",@"actual_sleep_short",@"fall_asleep_hard",@"wake_times_too_much",@"sleepace_efficient_low",@"benign_sleep"];
    obj.deductionValue=@[@"-5",@"-1",@"-5",@"-4",@"-7",@"-14"];
    obj.timezone=[NSNumber numberWithInteger:28800];
    obj.duration=[NSNumber numberWithInteger:413];
    obj.startTime=[NSNumber numberWithInteger:1479308418];
    obj.score=[NSNumber numberWithInteger:64];
    obj.light=[NSNumber numberWithInteger:263];
    obj.rem=[NSNumber numberWithInteger:72];
    obj.deep=[NSNumber numberWithInteger:28];
    obj.wake=[NSNumber numberWithInteger:106];
    obj.MdDeepSleepPerc=[NSNumber numberWithInteger:6];
    obj.MdRemSleepPerc=[NSNumber numberWithInteger:15];
    obj.MdLightSleepPerc=[NSNumber numberWithInteger:56];
    obj.MdWakeSleepPerc=[NSNumber numberWithInteger:23];;
    obj.MdWakeUpTime=[NSNumber numberWithInteger:62];
    obj.wake_times=[NSNumber numberWithInteger:2];
    obj.timeStep=[NSNumber numberWithInteger:60];
    obj.recordCount=[NSNumber numberWithInteger:469];
    obj.stopMode=[NSNumber numberWithInteger:0];
    obj.isupload=[NSNumber numberWithInteger:1];
    obj.asleepTime=[NSNumber numberWithInteger:50];
    obj.weekday=@"3";
    obj.week=@"47";
    obj.month=@"11";
    obj.year=@"2016";
    obj.bedTimeStr=@"23:00";
    obj.wakeUpTimeStr=@"06:43";
    obj.source=[NSNumber numberWithInteger:10];
    obj.timezone=[NSNumber numberWithInteger:28800];
    obj.reportFlag=[NSNumber numberWithInteger:1];
    obj.arithmeticVer=@"";
    
    return obj;
}

+ (UserObj *)dealwithData:(SLPHistoryData *)historyData
{
    
    M_HistoryDataDetail *detail =(M_HistoryDataDetail *)historyData.detail;
    M_HistoryDataAnalysis *analysis=(M_HistoryDataAnalysis *)historyData.analysis;
    
    UserObj *obj=[[UserObj alloc]init];
    obj.farmlyID=[NSNumber numberWithInteger:0];
    obj.memID=[NSNumber numberWithInteger:0];
    obj.timezone=[NSNumber numberWithInteger:[[NSTimeZone systemTimeZone] secondsFromGMT]];
    
    NSDate *startDate= [NSDate dateWithTimeIntervalSince1970:historyData.summary.startTime];
    NSDateFormatter *sd = [[NSDateFormatter alloc] init];
    [sd setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:obj.timezone.intValue]];
    sd.dateFormat = @"yyyy-MM-dd";
    obj.date= [sd stringFromDate:startDate];
    
    obj.reportFlag=[NSNumber numberWithInteger:historyData.summary.reportFlag];
    obj.InvalidFlag=[NSNumber numberWithInteger:((SLPMilkyHistoryData *)analysis).dataStatus];
    obj.SleepCurveStr=[NSString stringWithFormat:@"[%@]",[analysis.sleepCurveArray componentsJoinedByString:@","]];
    obj.sleepCurveStatusStr=[NSString stringWithFormat:@"[%@]",[analysis.sleepCurveStatusArray componentsJoinedByString:@","]];
    obj.duration=[NSNumber numberWithInteger:analysis.duration];
    obj.startTime=[NSNumber numberWithInteger:historyData.summary.startTime];
    obj.score=[NSNumber numberWithInteger:analysis.sleepScore];
    obj.light=[NSNumber numberWithInteger:analysis.lightSleepAllTime];
    obj.rem=[NSNumber numberWithInteger:analysis.inSleepAllTime];
    obj.deep=[NSNumber numberWithInteger:analysis.deepSleepAllTime];
    obj.wake=[NSNumber numberWithInteger:analysis.wakeAllTime];
    obj.MdDeepSleepPerc=[NSNumber numberWithInteger:analysis.deepSleepPerc];
    obj.MdRemSleepPerc=[NSNumber numberWithInteger:analysis.inSleepPerc];
    obj.MdLightSleepPerc=[NSNumber numberWithInteger:analysis.lightSleepPerc];
    obj.MdWakeSleepPerc=[NSNumber numberWithInteger:analysis.wakeSleepPerc];;
    obj.MdWakeUpTime=[NSNumber numberWithInteger:analysis.wakeAndLeaveBedBeforeAllTime];
    obj.wake_times=[NSNumber numberWithInteger:analysis.wakeTimes];
    obj.timeStep=[NSNumber numberWithInteger:60];
    obj.stopMode=[NSNumber numberWithInteger:0];
    obj.isupload=[NSNumber numberWithInteger:1];
    obj.asleepTime=[NSNumber numberWithInteger:analysis.fallAlseepAllTime];
    obj.source=[NSNumber numberWithInteger:10];
    obj.recordCount = [NSNumber numberWithInteger:historyData.summary.recordCount];
    obj.arithmeticVer= analysis.algorithmVer;
    
    NSTimeInterval startTime = obj.startTime.integerValue;//上床时间
    NSTimeInterval endTime = startTime + obj.recordCount.integerValue * 60;//起床时间
    NSTimeInterval awakeTime = endTime - obj.MdWakeUpTime.integerValue * 60;//醒来时间
    NSDate *asleepDate = [NSDate dateWithTimeIntervalSince1970:startTime];
    NSDate *wakeupDate = [NSDate dateWithTimeIntervalSince1970:awakeTime];
    NSDateFormatter *df = [[NSDateFormatter alloc] init];
    [df setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:obj.timezone.intValue]];
    df.dateFormat = @"HH:mm";
    obj.bedTimeStr = [df stringFromDate:asleepDate];
    obj.wakeUpTimeStr = [df stringFromDate:wakeupDate];
    obj.deductionName=[self backDeductionArrayyFromAnalysis:analysis][0];
    obj.deductionValue=[self backDeductionArrayyFromAnalysis:analysis][1];
    
    //    NSLog(@"date-----%@,duration----%@,start time==%@",obj.date,obj.duration,obj.startTime);
    
    return obj;
}

@end
